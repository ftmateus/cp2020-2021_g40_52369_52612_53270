\subsubsection{Description}

During the energy bombardment phase, the layer is being bombarded by multiple particles. When a cell is hit by a particle, the impact cell and the ones near it receive some of the particle's energy and the further a neighboring cell is to the impact cell, the less energy it receives.

When a cell is far enough from the point of impact of the particle, to the point where the energy it receives is below a certain threshold (which depends on the material), the value of the energy received is counted as negligible and it is not added to the cell.

\subsubsection{Parallel version implementation}

Depending on the particle, there could be time saved by only updating the values of certain cells. Since the bigger the distance from the cell of impact, the lower the energy on subsequent cells, after a certain point it becomes unnecessary to calculate the energy that the subsequent cells receive, because if the current cell is below the threshold, the next cell will also be, because the energy received can only go lower.

This makes it so that it is only necessary to calculate the cells within a certain distance from the impact point, to calculate that distance we go to the attenuation formula and replace the energy that the particle receives for the threshold, the distance is the squared of the attenuation.

By adding the distance to the position of the impact cell, we get the farthest point we get the maximum cell, where cells above will not be updated. By subtracting the distance to the position of the impact cell, we get the minimum cell, where cells below will not be updated.

So instead of trying to update the whole layer, and only updating the relevant cells, it now only updates from the minimum cell to the maximum cell.

The second step is to divide the resulting layer for each thread using OMP. Since the update function is made so that each thread can work with different cells, there will never be any concurrency issue among them.

Another approach could have been for instead of dividing the layer for each thread, dividing the storm particles for each thread. This would make it so the layer is shared among threads, adding concurrency issues on updating the same cells. To bypass this, there's the possibility of updating the cells atomically, wasting the power of concurrency, or having each thread work on its own copy of the layer, and adding them all at the end. which would drastically increase space used and also adding time by adding them at the end.



